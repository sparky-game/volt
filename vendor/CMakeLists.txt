file(GLOB IMGUI_SRCS CONFIGURE_DEPENDS "imgui/*.cpp")
file(GLOB BOX2D_SRCS CONFIGURE_DEPENDS "box2d/src/*.c")
file(GLOB RAYLIB_SRCS CONFIGURE_DEPENDS "raylib/src/*.c")
file(GLOB IMGUIZMO_SRCS CONFIGURE_DEPENDS "imguizmo/*.cpp")
file(GLOB_RECURSE YAML_CPP_SRCS CONFIGURE_DEPENDS "yaml-cpp/src/*.cpp")
file(GLOB IMGUI_IMPL_RAYLIB_SRCS CONFIGURE_DEPENDS "imgui_impl_raylib/*.cpp")

add_library(imgui OBJECT ${IMGUI_SRCS})
add_library(box2d OBJECT ${BOX2D_SRCS})
add_library(raylib OBJECT ${RAYLIB_SRCS})
add_library(imguizmo OBJECT ${IMGUIZMO_SRCS})
add_library(yaml_cpp OBJECT ${YAML_CPP_SRCS})
add_library(imgui_impl_raylib OBJECT ${IMGUI_IMPL_RAYLIB_SRCS})

target_compile_definitions(raylib PRIVATE PLATFORM_DESKTOP)
target_compile_definitions(yaml_cpp PRIVATE YAML_CPP_STATIC_DEFINE)
if (VOLT_USE_SIMD)
  target_compile_definitions(box2d PRIVATE BOX2D_ENABLE_SIMD)
endif()

target_include_directories(imguizmo SYSTEM PUBLIC imgui)
target_include_directories(box2d SYSTEM PUBLIC box2d/include)
target_include_directories(imgui_impl_raylib SYSTEM PUBLIC imgui)
target_include_directories(box2d SYSTEM PUBLIC box2d/extern/simde)
target_include_directories(yaml_cpp SYSTEM PUBLIC yaml-cpp/include)
target_include_directories(imgui_impl_raylib SYSTEM PUBLIC raylib/src)
target_include_directories(raylib SYSTEM PUBLIC raylib/src/external/glfw/include)

target_compile_options(raylib PRIVATE "-w")
target_compile_options(box2d PRIVATE "-ffp-contract=off")
target_compile_options(raylib PRIVATE "-Wno-implicit-function-declaration")

if (VOLT_USE_AVX2)
  target_compile_definitions(box2d PRIVATE BOX2D_AVX2)
  if (MSVC)
    target_compile_options(box2d PRIVATE "/arch:AVX2")
  else()
    target_compile_options(box2d PRIVATE "-mavx2")
  endif()
endif()

if (APPLE)
  target_compile_options(raylib PRIVATE "-ObjC")
endif()
